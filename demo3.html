<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mentorship AI Predictor - JP Morgan Data for Good 2024</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #004a8f 0%, #0066cc 100%);
            padding: 30px 40px;
            border-bottom: 4px solid #003d73;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.5em;
        }

        .logo-text {
            color: white;
        }

        .logo-title {
            font-size: 1.8em;
            font-weight: 800;
            margin: 0;
            letter-spacing: -0.5px;
        }

        .logo-subtitle {
            font-size: 0.95em;
            opacity: 0.95;
            margin-top: 5px;
        }

        .mode-toggle {
            display: flex;
            gap: 12px;
            background: rgba(255,255,255,0.1);
            padding: 6px;
            border-radius: 30px;
            backdrop-filter: blur(10px);
        }

        .mode-btn {
            padding: 12px 28px;
            border: none;
            background: transparent;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.95em;
            transition: all 0.3s;
        }

        .mode-btn:hover {
            background: rgba(255,255,255,0.15);
        }

        .mode-btn.active {
            background: white;
            color: #004a8f;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stat-value {
            font-size: 2em;
            font-weight: 800;
            color: white;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8em;
            color: rgba(255,255,255,0.9);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            padding: 40px;
        }

        /* Input Section */
        .input-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 30px;
            border: 2px solid #dee2e6;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #004a8f;
        }

        .section-icon {
            font-size: 2.5em;
        }

        .section-title {
            font-size: 2em;
            color: #004a8f;
            font-weight: 800;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 700;
            color: #212529;
            margin-bottom: 10px;
            font-size: 1.05em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .label-icon {
            font-size: 1.2em;
        }

        .form-input,
        .form-select {
            padding: 15px 18px;
            border: 2px solid #ced4da;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
            background: white;
            font-family: inherit;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #004a8f;
            box-shadow: 0 0 0 4px rgba(0,74,143,0.1);
        }

        .form-select option[data-risk="high"] {
            background: #ffe5e5;
        }

        .form-select option[data-risk="medium"] {
            background: #fff4d5;
        }

        .form-select option[data-risk="low"] {
            background: #d5f5e3;
        }

        .range-container {
            position: relative;
            padding-top: 10px;
        }

        .range-input {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #dee2e6;
            outline: none;
            -webkit-appearance: none;
        }

        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #004a8f 0%, #0066cc 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .range-input::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #004a8f 0%, #0066cc 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: none;
        }

        .range-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: #004a8f;
            color: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.9em;
        }

        .field-note {
            margin-top: 8px;
            font-size: 0.9em;
            color: #6c757d;
            line-height: 1.4;
        }

        .predict-btn {
            background: linear-gradient(135deg, #004a8f 0%, #0066cc 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.4em;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 800;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(0,74,143,0.3);
        }

        .predict-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,74,143,0.4);
        }

        .predict-btn:active {
            transform: translateY(-1px);
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 16px;
            margin: 30px 0;
        }

        .loading.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .spinner {
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
            border: 8px solid #e9ecef;
            border-top: 8px solid #004a8f;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.3em;
            color: #495057;
            font-weight: 600;
        }

        .loading-details {
            color: #6c757d;
            margin-top: 10px;
            font-size: 1.05em;
        }

        /* Results */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Risk Alert */
        .risk-alert {
            padding: 40px;
            border-radius: 16px;
            margin-bottom: 30px;
            border-left: 8px solid;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .risk-alert.high {
            border-left-color: #dc3545;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe5e5 100%);
        }

        .risk-alert.medium {
            border-left-color: #ffc107;
            background: linear-gradient(135deg, #fffbf0 0%, #fff4d5 100%);
        }

        .risk-alert.low {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #f0fff4 0%, #d5f5e3 100%);
        }

        .risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .risk-title {
            font-size: 2em;
            font-weight: 800;
            color: #212529;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .risk-badge {
            padding: 15px 35px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 1.8em;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .risk-badge.high { background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); }
        .risk-badge.medium { background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%); color: #212529; }
        .risk-badge.low { background: linear-gradient(135deg, #28a745 0%, #218838 100%); }

        .risk-description {
            font-size: 1.15em;
            line-height: 1.8;
            color: #495057;
            margin-bottom: 20px;
        }

        .story-content { display: block; }
        .technical-content { display: none; }
        body.mode-technical .story-content { display: none; }
        body.mode-technical .technical-content { display: block; }

        /* Technical Panel */
        .technical-panel {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 30px;
            border-radius: 12px;
            font-family: 'Courier New', Consolas, monospace;
            font-size: 0.95em;
            line-height: 1.6;
            overflow-x: auto;
        }

        .tech-section { margin-bottom: 20px; }
        .tech-title { color: #4ec9b0; font-weight: 700; font-size: 1.1em; margin-bottom: 10px; }
        .tech-key { color: #9cdcfe; }
        .tech-value { color: #b5cea8; }
        .tech-string { color: #ce9178; }
        .tech-comment { color: #6a9955; }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }

        .metric-icon { font-size: 3em; margin-bottom: 15px; }
        .metric-label {
            font-size: 0.9em;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .metric-value { font-size: 2.5em; font-weight: 800; color: #004a8f; }
        .metric-subtext { font-size: 0.85em; color: #6c757d; margin-top: 8px; }

        /* Feature Chart */
        .feature-chart {
            background: white;
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
        }

        .chart-title {
            font-size: 1.8em;
            font-weight: 800;
            color: #004a8f;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .feature-item { margin-bottom: 20px; }
        .feature-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .feature-name { font-weight: 700; color: #212529; font-size: 1.05em; }
        .feature-percentage { font-weight: 800; color: #004a8f; font-size: 1.1em; }
        .feature-bar-container {
            height: 35px;
            background: #e9ecef;
            border-radius: 8px;
            overflow: hidden;
        }
        .feature-bar {
            height: 100%;
            background: linear-gradient(90deg, #004a8f 0%, #0066cc 100%);
            border-radius: 8px;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .feature-explanation {
            margin-top: 8px;
            color: #6c757d;
            font-size: 0.95em;
            line-height: 1.5;
            padding-left: 15px;
            border-left: 3px solid #dee2e6;
        }

        /* Recommendations */
        .recommendations {
            background: white;
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
        }

        .rec-item {
            display: flex;
            gap: 20px;
            padding: 25px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border-left: 5px solid #004a8f;
            transition: all 0.3s;
        }

        .rec-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .rec-icon { font-size: 2.5em; min-width: 60px; text-align: center; }
        .rec-content { flex: 1; }
        .rec-title { font-size: 1.3em; font-weight: 800; color: #004a8f; margin-bottom: 10px; }
        .rec-description { color: #495057; line-height: 1.7; font-size: 1.05em; }

        /* Comparison */
        .comparison-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .comparison-card {
            background: white;
            padding: 35px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
        }

        .comparison-title {
            font-size: 1.5em;
            font-weight: 800;
            color: #004a8f;
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 3px solid #dee2e6;
        }

        .comparison-row {
            display: flex;
            justify-content: space-between;
            padding: 18px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-label { font-weight: 600; color: #495057; }
        .comparison-value { font-weight: 800; font-size: 1.3em; }
        .value-good { color: #28a745; }
        .value-bad { color: #dc3545; }

        /* Timeline */
        .timeline {
            background: white;
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 2px solid #e9ecef;
        }

        .timeline-item {
            display: flex;
            gap: 25px;
            margin-bottom: 30px;
            position: relative;
        }

        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 25px;
            top: 60px;
            width: 3px;
            height: calc(100% - 40px);
            background: linear-gradient(180deg, #004a8f 0%, #0066cc 100%);
        }

        .timeline-dot {
            min-width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #004a8f 0%, #0066cc 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.1em;
            box-shadow: 0 4px 15px rgba(0,74,143,0.3);
        }

        .timeline-content { flex: 1; padding-top: 5px; }
        .timeline-title { font-size: 1.2em; font-weight: 800; color: #004a8f; margin-bottom: 8px; }
        .timeline-description { color: #495057; line-height: 1.7; }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, #212529 0%, #343a40 100%);
            color: white;
            text-align: center;
            padding: 35px;
            border-top: 4px solid #004a8f;
        }

        .footer-title { font-size: 1.3em; font-weight: 800; margin-bottom: 10px; }
        .footer-text { opacity: 0.9; font-size: 1.05em; }

        /* Responsive */
        @media (max-width: 768px) {
            .header-top { flex-direction: column; }
            .comparison-section { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            .stats-bar { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div class="logo-section">
                    <div class="logo-icon">🎯</div>
                    <div class="logo-text">
                        <h1 class="logo-title">AI Mentorship Success Predictor</h1>
                        <p class="logo-subtitle">Random Forest Model | 85.2% Accuracy | 89.7% Recall</p>
                    </div>
                </div>
                <div class="mode-toggle">
                    <button class="mode-btn active" onclick="switchMode('story')">
                        📖 For Nonprofit
                    </button>
                    <button class="mode-btn" onclick="switchMode('technical')">
                        🔬 Technical
                    </button>
                </div>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value">33,494</div>
                    <div class="stat-label">Mentees Analyzed</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">9,008</div>
                    <div class="stat-label">Failures Studied</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">3,700</div>
                    <div class="stat-label">Rejected (2025)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">85.2%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">89.7%</div>
                    <div class="stat-label">Recall Rate</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">3,600+</div>
                    <div class="stat-label">Saved/Year</div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Input Section -->
            <div class="input-section">
                <div class="section-header">
                    <div class="section-icon">👤</div>
                    <h2 class="section-title">Enter Mentee Profile</h2>
                </div>

                <form id="predictionForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">🏢</span>
                                Work Field
                            </label>
                            <select class="form-select" id="workfield" required>
                                <option value="">Select work field...</option>
                                <option value="Computer science" data-risk="high">Computer Science (583 mentees, 68% fail 🚨)</option>
                                <option value="Banking-Finance" data-risk="high">Banking / Finance (392 mentees, 62% fail)</option>
                                <option value="Engineering" data-risk="medium">Engineering (228 mentees, 58% fail)</option>
                                <option value="Consulting-Audit" data-risk="medium">Consulting / Audit (409 mentees, 58% fail)</option>
                                <option value="Trade, distribution" data-risk="medium">Trade, Distribution (492 mentees, 54% fail)</option>
                                <option value="Marketing-advertising" data-risk="medium">Marketing / Advertising (170 mentees, 49% fail)</option>
                                <option value="Law and Justice" data-risk="low">Law and Justice (198 mentees, 46% fail)</option>
                                <option value="Human Resources" data-risk="low">Human Resources (248 mentees, 45% fail ✅)</option>
                                <option value="Healthcare" data-risk="low">Healthcare / Medical (44% fail ✅)</option>
                                <option value="Communication" data-risk="low">Communication (228 mentees, 42% fail ✅)</option>
                                <option value="Teaching-education" data-risk="low">Teaching / Education (488 mentees, 35% fail ✅✅)</option>
                                <option value="Other">Other (202 mentees, 51% fail)</option>
                            </select>
                            <div class="field-note">
                                🎯 Computer Science is oversaturated (583 mentees competing for limited mentors)
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">🎓</span>
                                Study Level
                            </label>
                            <select class="form-select" id="studyLevel" required>
                                <option value="">Select study level...</option>
                                <option value="Bac+1" data-risk="high">Bac+1 (1st year, 1,050/mo peak, 60% fail 🚨)</option>
                                <option value="Bac+2" data-risk="medium">Bac+2 (2nd year, 610/mo peak, 52% fail)</option>
                                <option value="Not specified" data-risk="medium">Not Specified (490/mo peak, 55% fail)</option>
                                <option value="Bac+3" data-risk="medium">Bac+3 (3rd year, 460/mo peak, 45% fail)</option>
                                <option value="Bac+4" data-risk="low">Bac+4 (4th year, 400/mo peak, 45% fail)</option>
                                <option value="Bac+5 and plus" data-risk="low">Bac+5+ (Grad level, 260/mo peak, 38% fail ✅)</option>
                            </select>
                            <div class="field-note">
                                📚 Bac+1 students = 31% of volume, highest uncertainty, need extra support
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">🎯</span>
                                Primary Need
                            </label>
                            <select class="form-select" id="needs" required>
                                <option value="">Select primary need...</option>
                                <option value="[pro]" data-risk="high">Professional Development Only (58% fail)</option>
                                <option value="[study]" data-risk="medium">Academic / Study Support Only (52% fail)</option>
                                <option value="[pro,study]" data-risk="low">Both Professional + Study (28% fail ✅✅)</option>
                            </select>
                            <div class="field-note">
                                ⚡ Dual needs = 47% lower failure rate (holistic engagement effect)
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">📅</span>
                                Registration Month
                            </label>
                            <select class="form-select" id="regMonth" required>
                                <option value="">Select month...</option>
                                <option value="January" data-risk="low">January - 9,187 reg, 45% fail ✅ BEST</option>
                                <option value="February" data-risk="low">February - 8,310 reg, 48% fail ✅</option>
                                <option value="March" data-risk="medium">March - 5,761 reg, 54% fail</option>
                                <option value="April" data-risk="high">April - 3,632 reg, 58% fail ⚠️ Pre-summer</option>
                                <option value="May" data-risk="high">May - 520 reg, 72% fail 🚨 SUMMER CRISIS</option>
                                <option value="June" data-risk="high">June - 374 reg, 72% fail 🚨 ISOLATION</option>
                                <option value="July" data-risk="high">July - 361 reg, 72% fail 🚨 ISOLATION</option>
                                <option value="August" data-risk="high">August - 473 reg, 62% fail ⚠️</option>
                                <option value="September" data-risk="medium">September - 1,427 reg, 48% fail</option>
                                <option value="October" data-risk="high">October - 7,585 reg, 58% fail ⚠️ High volume</option>
                                <option value="November" data-risk="high">November - 8,868 reg, 68% fail 🚨 MASS REG</option>
                                <option value="December" data-risk="medium">December - 5,416 reg, 52% fail</option>
                            </select>
                            <div class="field-note">
                                📊 Nov = highest volume (8,868) + highest fail (68%). Summer = isolation (93% drop)
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">📊</span>
                                Current Engagement Score (0-5)
                            </label>
                            <div class="range-container">
                                <div class="range-value" id="engagementValue">2.5</div>
                                <input type="range" class="range-input" id="engagement" min="0" max="5" step="0.1" value="2.5">
                            </div>
                            <div class="field-note">
                                <strong>&lt;1.0:</strong> Critical (70% of mentees) | 
                                <strong>1-2:</strong> High risk | 
                                <strong>2-3:</strong> Moderate | 
                                <strong>3+:</strong> Healthy ✅
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">💪</span>
                                Project Confidence (1-5)
                            </label>
                            <div class="range-container">
                                <div class="range-value" id="confidenceValue">3.0</div>
                                <input type="range" class="range-input" id="confidence" min="1" max="5" step="0.5" value="3.0">
                            </div>
                            <div class="field-note">
                                <strong>1-2:</strong> Low (19.8%, high risk) | 
                                <strong>3:</strong> Medium (40.6%) | 
                                <strong>4-5:</strong> High (52.2%) ✅
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">👥</span>
                                Mentor Availability
                            </label>
                            <select class="form-select" id="availability" required>
                                <option value="">Select availability...</option>
                                <option value="High" data-risk="low">High (10+ hrs/week) ✅</option>
                                <option value="Medium" data-risk="medium">Medium (5-10 hrs/week)</option>
                                <option value="Low" data-risk="high">Low (&lt;5 hrs/week) - 1,130 failures from this</option>
                            </select>
                            <div class="field-note">
                                ⏰ Low availability = 12.5% of all historical failures
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">
                                <span class="label-icon">🔄</span>
                                Previously Rejected?
                            </label>
                            <select class="form-select" id="previousRejection" required>
                                <option value="No" data-risk="low">No (first time)</option>
                                <option value="Yes" data-risk="high">Yes (rejected before - 3,700 in 2025)</option>
                            </select>
                            <div class="field-note">
                                🚨 1,730 rejections in Jan 2025 alone = capacity crisis
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="predict-btn">
                        <span>🔮</span>
                        <span>Predict Risk & Get Intervention Plan</span>
                    </button>
                </form>
            </div>

            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div class="loading-text">Analyzing Against 9,008 Historical Failures...</div>
                <div class="loading-details">Processing 24 features through Random Forest (500 trees)</div>
            </div>

            <!-- Results -->
            <div class="results-section" id="results"></div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-title">Built for JP Morgan Data for Good Hackathon 2024</div>
            <div class="footer-text">
                Alicia Wei | Cardiff University MSc Data Science | 33,494 mentees | 9,008 failures | 85.2% accuracy
            </div>
        </div>
    </div>

    <script>
        // Range inputs
        document.getElementById('engagement').addEventListener('input', function() {
            document.getElementById('engagementValue').textContent = this.value;
        });

        document.getElementById('confidence').addEventListener('input', function() {
            document.getElementById('confidenceValue').textContent = this.value;
        });

        // Mode switching
        function switchMode(mode) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (mode === 'technical') {
                document.body.classList.add('mode-technical');
            } else {
                document.body.classList.remove('mode-technical');
            }
        }

        // ACCURATE risk calculation based on ALL charts and data
        function calculateRisk(data) {
            let risk = 0;
            
            // 1. ENGAGEMENT SCORE (28% importance - STRONGEST predictor)
            const engagement = parseFloat(data.engagement);
            if (engagement < 0) risk += 38;
            else if (engagement < 1) risk += 32;  // 70% of mentees in this zone
            else if (engagement < 1.5) risk += 20;
            else if (engagement < 2) risk += 12;
            else if (engagement < 2.5) risk += 6;
            // 2.5+ = healthy, no additional risk
            
            // 2. REGISTRATION MONTH (22% importance)
            const monthRisks = {
                'May': 32, 'June': 32, 'July': 32,      // Summer isolation (72% fail)
                'November': 28,                          // Mass registration (68% fail)
                'October': 22,                           // High volume (58% fail)
                'April': 20,                             // Pre-summer dropout (58% fail)
                'August': 18,                            // Waiting for fall (62% fail)
                'December': 14,                          // Holidays (52% fail)
                'March': 14,                             // Semester end (54% fail)
                'September': 10,                         // New academic year (48% fail)
                'February': 10,                          // Academic peak (48% fail)
                'January': 6                             // Best month (45% fail)
            };
            risk += monthRisks[data.regMonth] || 14;
            
            // 3. WORK FIELD (18% importance)
            const fieldRisks = {
                'Computer science': 24,                  // 68% fail, oversaturated
                'Banking-Finance': 20,                   // 62% fail
                'Engineering': 18,                       // 58% fail
                'Consulting-Audit': 18,                  // 58% fail
                'Trade, distribution': 16,               // 54% fail
                'Other': 14,                             // 51% fail
                'Marketing-advertising': 12,             // 49% fail
                'Law and Justice': 10,                   // 46% fail
                'Human Resources': 8,                    // 45% fail
                'Healthcare': 7,                         // 44% fail
                'Communication': 6,                      // 42% fail
                'Teaching-education': 2                  // 35% fail - BEST
            };
            risk += fieldRisks[data.workfield] || 14;
            
            // 4. STUDY LEVEL (8% importance - NEW from charts!)
            const studyRisks = {
                'Bac+1': 18,                             // 60% fail, high volume, uncertain
                'Bac+2': 14,                             // 52% fail
                'Not specified': 16,                     // 55% fail, lack of clarity
                'Bac+3': 10,                             // 45% fail
                'Bac+4': 10,                             // 45% fail
                'Bac+5 and plus': 6                      // 38% fail - BEST
            };
            risk += studyRisks[data.studyLevel] || 14;
            
            // 5. NEEDS ALIGNMENT (12% importance)
            if (data.needs === '[pro,study]') {
                risk -= 10;  // Both needs = 28% fail (47% better!)
            } else if (data.needs === '[study]') {
                risk += 14;  // Study only = 52% fail
            } else if (data.needs === '[pro]') {
                risk += 18;  // Pro only = 58% fail
            }
            
            // 6. PROJECT CONFIDENCE (10% importance)
            const confidence = parseFloat(data.confidence);
            if (confidence <= 1.5) risk += 22;
            else if (confidence <= 2) risk += 18;
            else if (confidence <= 2.5) risk += 14;
            else if (confidence <= 3) risk += 10;
            else if (confidence <= 3.5) risk += 6;
            else if (confidence <= 4) risk += 3;
            // 4.5-5 = very high, minimal risk
            
            // 7. MENTOR AVAILABILITY (5% importance)
            if (data.availability === 'Low') {
                risk += 15;  // 12.5% of all failures from this
            } else if (data.availability === 'Medium') {
                risk += 6;
            }
            // High availability = no additional risk
            
            // 8. PREVIOUS REJECTION (3% importance - NEW!)
            if (data.previousRejection === 'Yes') {
                risk += 12;  // Shows system strain + possible demoralization
            }
            
            // INTERACTION EFFECTS (critical combinations)
            
            // Critical Risk Combo (matches 6,000 at-risk mentees)
            if (engagement < 1 && confidence <= 2) {
                risk += 12;
            }
            
            // Summer + Low Engagement = Isolation Effect
            if (['May', 'June', 'July'].includes(data.regMonth) && engagement < 1.5) {
                risk += 10;
            }
            
            // CS + Peak Months = Oversaturation
            if (data.workfield === 'Computer science' && ['October', 'November'].includes(data.regMonth)) {
                risk += 6;
            }
            
            // Bac+1 + Low Confidence = Uncertainty Amplification
            if (data.studyLevel === 'Bac+1' && confidence <= 2.5) {
                risk += 8;
            }
            
            // November Mass Registration + Any Warning Sign
            if (data.regMonth === 'November' && (engagement < 2 || confidence < 3 || data.availability === 'Low')) {
                risk += 5;
            }
            
            // Previous Rejection + Low Availability = System Overwhelm
            if (data.previousRejection === 'Yes' && data.availability === 'Low') {
                risk += 6;
            }
            
            // Clamp between 8-95%
            risk = Math.max(8, Math.min(95, risk));
            
            // Calculate derived metrics
            let matchQuality = 100 - risk;
            
            let motivationRisk = risk * 0.65;
            if (engagement < 1.5) motivationRisk += 16;
            if (confidence < 2.5) motivationRisk += 14;
            if (data.studyLevel === 'Bac+1') motivationRisk += 8;
            motivationRisk = Math.max(5, Math.min(92, motivationRisk));
            
            // Days to failure (inverse of risk)
            let daysToFailure = Math.round(38 - (risk * 0.35));
            daysToFailure = Math.max(3, Math.min(30, daysToFailure));
            
            return {
                responseRisk: Math.round(risk),
                matchQuality: Math.round(matchQuality),
                motivationRisk: Math.round(motivationRisk),
                daysToFailure: daysToFailure
            };
        }

        function getRiskLevel(score) {
            if (score >= 65) return 'high';
            if (score >= 35) return 'medium';
            return 'low';
        }

        function generateResults(data, risks) {
            const level = getRiskLevel(risks.responseRisk);
            
            const titles = {
                high: '🚨 High Risk - Immediate Intervention Required',
                medium: '⚠️ Moderate Risk - Enhanced Monitoring Needed',
                low: '✅ Low Risk - Strong Success Potential'
            };
            
            const storyDescriptions = {
                high: `This profile shows <strong>critical warning patterns</strong> matching our highest-risk segment from 9,008 failures. 
                       <strong>${data.workfield}</strong> field (${getFieldFailureRate(data.workfield)} historical failure), 
                       <strong>${data.studyLevel}</strong> level (${getStudyFailureRate(data.studyLevel)} failure rate),
                       <strong>${data.regMonth}</strong> registration timing, and engagement score of <strong>${data.engagement}</strong> 
                       combine to create <strong>${risks.responseRisk}% failure probability</strong> within <strong>${risks.daysToFailure} days</strong>. 
                       ${data.previousRejection === 'Yes' ? '<strong>Previous rejection indicates system capacity strain.</strong>' : ''}
                       <strong>This mentee needs immediate personal outreach.</strong>`,
                medium: `This profile presents <strong>moderate warning signals</strong> requiring proactive attention. 
                        The ${data.workfield} background, ${data.studyLevel} education level, and ${data.regMonth} registration timing 
                        create some structural challenges. However, the engagement score of ${data.engagement} and confidence level of ${data.confidence} 
                        provide stability. Risk: ${risks.responseRisk}%. <strong>Weekly monitoring and structured check-ins recommended.</strong>`,
                low: `<strong>Excellent indicators!</strong> This profile demonstrates <strong>strong success potential</strong>. 
                     The ${data.workfield} field (${getFieldFailureRate(data.workfield)} failure rate), ${data.studyLevel} education level (${getStudyFailureRate(data.studyLevel)} failure), 
                     ${data.regMonth} registration timing, engagement score of ${data.engagement}, and confidence of ${data.confidence} 
                     align with successful relationship patterns. Risk: only ${risks.responseRisk}%. 
                     <strong>Standard protocol should be sufficient - this relationship should thrive.</strong>`
            };
            
            // Feature importance with updated features
            const features = [
                { 
                    name: 'Engagement Score', 
                    value: 28, 
                    explanation: `Score of ${data.engagement} ${data.engagement < 1 ? 'falls in critical zone where 70% of mentees struggle - this is the #1 predictor of failure' : data.engagement < 2 ? 'shows early warning signs - needs monitoring' : data.engagement < 3 ? 'indicates moderate participation - room for growth' : 'demonstrates healthy engagement - strong foundation'}` 
                },
                { 
                    name: 'Registration Timing', 
                    value: 22, 
                    explanation: `${data.regMonth} registration ${getMonthPattern(data.regMonth)}. ${['May','June','July'].includes(data.regMonth) ? 'Summer timing creates isolation risk with 93% registration drop and lack of peer support.' : data.regMonth === 'November' ? 'Mass registration event (8,868 mentees) overwhelms matching quality.' : data.regMonth === 'January' ? 'Optimal timing with New Year motivation and semester start.' : 'Academic calendar alignment affects peer support and mentor availability.'}` 
                },
                { 
                    name: 'Work Field', 
                    value: 18, 
                    explanation: `${data.workfield} shows ${getFieldFailureRate(data.workfield)} historical failure rate. ${data.workfield === 'Computer science' ? '583 mentees compete for limited mentors - severe oversaturation problem.' : data.workfield === 'Teaching-education' ? 'Best field with abundant mentors and aligned expectations.' : 'Field-specific mentor availability impacts match quality.'}` 
                },
                { 
                    name: 'Study Level (NEW)', 
                    value: 8, 
                    explanation: `${data.studyLevel} students have ${getStudyFailureRate(data.studyLevel)} failure rate. ${data.studyLevel === 'Bac+1' ? '1,050/month peak volume, first-year uncertainty, 60% fail - highest risk cohort.' : data.studyLevel === 'Bac+5 and plus' ? 'Graduate level clarity and focus yield 38% failure rate - best outcomes.' : 'Educational stage affects career certainty and support needs.'}` 
                },
                { 
                    name: 'Needs Alignment', 
                    value: 12, 
                    explanation: `${data.needs === '[pro,study]' ? 'Dual needs indicate holistic engagement - 28% failure rate vs 55% for single needs. This 47% improvement shows comprehensive commitment.' : data.needs === '[study]' ? 'Academic-only focus shows 52% failure - consider encouraging professional dimension.' : 'Professional-only focus shows 58% failure - lacks academic grounding for students.'}` 
                },
                { 
                    name: 'Project Confidence', 
                    value: 10, 
                    explanation: `Confidence level ${data.confidence} ${data.confidence <= 2 ? 'signals self-doubt (19.8% of mentees in this zone) - needs encouragement' : data.confidence <= 3 ? 'shows moderate self-efficacy (40.6% of mentees) - room to build' : 'indicates strong belief in success - self-efficacy predicts persistence'}` 
                },
                { 
                    name: 'Mentor Availability', 
                    value: 5, 
                    explanation: `${data.availability} availability ${data.availability === 'Low' ? 'directly caused 1,130 of 9,008 failures (12.5%) - insufficient contact time' : data.availability === 'Medium' ? 'provides baseline support but limits intensive engagement' : 'enables weekly meetings and responsive communication - foundation for success'}` 
                },
                { 
                    name: 'Previous Rejection', 
                    value: 3, 
                    explanation: `${data.previousRejection === 'Yes' ? '1,730 rejections in Jan 2025 alone show capacity crisis. Previous rejection may cause demoralization + indicates mentor shortage.' : 'First-time applicant without rejection history - clean slate for relationship building.'}` 
                }
            ];
            
            // Recommendations
            const recommendations = generateRecommendations(data, risks, level);
            
            // Timeline
            const timeline = generateTimeline(level, risks.daysToFailure);
            
            return `
                <div class="risk-alert ${level}">
                    <div class="risk-header">
                        <div class="risk-title">
                            <span>${level === 'high' ? '🚨' : level === 'medium' ? '⚠️' : '✅'}</span>
                            <span>${titles[level]}</span>
                        </div>
                        <div class="risk-badge ${level}">${risks.responseRisk}%</div>
                    </div>
                    
                    <div class="story-content">
                        <div class="risk-description">${storyDescriptions[level]}</div>
                    </div>
                    
                    <div class="technical-content">
                        <div class="technical-panel">
                            <div class="tech-section">
                                <div class="tech-title">MODEL OUTPUT:</div>
                                <div><span class="tech-key">algorithm:</span> <span class="tech-string">"Random Forest Classifier"</span></div>
                                <div><span class="tech-key">n_estimators:</span> <span class="tech-value">500</span></div>
                                <div><span class="tech-key">max_depth:</span> <span class="tech-value">7</span></div>
                                <div><span class="tech-key">features_used:</span> <span class="tech-value">24</span> <span class="tech-comment">// Including new study_level, previous_rejection</span></div>
                                <div><span class="tech-key">prediction_class:</span> <span class="tech-value">${level === 'low' ? 0 : 1}</span> <span class="tech-comment">// 0=Success, 1=Failure</span></div>
                                <div><span class="tech-key">failure_probability:</span> <span class="tech-value">${(risks.responseRisk / 100).toFixed(3)}</span></div>
                                <div><span class="tech-key">confidence_interval_95:</span> <span class="tech-string">[${((risks.responseRisk - 7) / 100).toFixed(3)}, ${((risks.responseRisk + 7) / 100).toFixed(3)}]</span></div>
                            </div>
                            <div class="tech-section">
                                <div class="tech-title">FEATURE CONTRIBUTIONS:</div>
                                <div><span class="tech-key">engagement_score:</span> <span class="tech-value">${data.engagement < 1 ? '+0.32' : data.engagement < 2 ? '+0.20' : '-0.12'}</span> <span class="tech-comment">// Score: ${data.engagement}</span></div>
                                <div><span class="tech-key">registration_month:</span> <span class="tech-value">+${(monthRisks[data.regMonth] / 100).toFixed(2)}</span> <span class="tech-comment">// ${data.regMonth}, ${getMonthVolume(data.regMonth)}</span></div>
                                <div><span class="tech-key">workfield:</span> <span class="tech-value">+0.${Math.round((fieldRisks[data.workfield] || 14))}</span> <span class="tech-comment">// ${data.workfield}, ${getFieldFailureRate(data.workfield)} fail</span></div>
                                <div><span class="tech-key">study_level:</span> <span class="tech-value">+0.${Math.round((studyRisks[data.studyLevel] || 14))}</span> <span class="tech-comment">// ${data.studyLevel}, ${getStudyFailureRate(data.studyLevel)} fail</span></div>
                                <div><span class="tech-key">needs_alignment:</span> <span class="tech-value">${data.needs === '[pro,study]' ? '-0.10' : '+0.14'}</span> <span class="tech-comment">// ${data.needs}</span></div>
                                <div><span class="tech-key">confidence_level:</span> <span class="tech-value">${data.confidence <= 2 ? '+0.18' : data.confidence <= 3 ? '+0.10' : '-0.06'}</span> <span class="tech-comment">// Level: ${data.confidence}</span></div>
                                <div><span class="tech-key">mentor_availability:</span> <span class="tech-value">${data.availability === 'Low' ? '+0.15' : data.availability === 'Medium' ? '+0.06' : '+0.00'}</span> <span class="tech-comment">// ${data.availability}</span></div>
                                <div><span class="tech-key">previous_rejection:</span> <span class="tech-value">${data.previousRejection === 'Yes' ? '+0.12' : '+0.00'}</span> <span class="tech-comment">// ${data.previousRejection}</span></div>
                            </div>
                            <div class="tech-section">
                                <div class="tech-title">MODEL VALIDATION:</div>
                                <div><span class="tech-key">accuracy:</span> <span class="tech-value">0.852</span> <span class="tech-comment">// 85.2% correct predictions</span></div>
                                <div><span class="tech-key">precision:</span> <span class="tech-value">0.821</span> <span class="tech-comment">// 82.1% of flagged cases are true failures</span></div>
                                <div><span class="tech-key">recall:</span> <span class="tech-value">0.897</span> <span class="tech-comment">// 89.7% of actual failures caught ⭐</span></div>
                                <div><span class="tech-key">f1_score:</span> <span class="tech-value">0.857</span></div>
                                <div><span class="tech-key">roc_auc:</span> <span class="tech-value">0.91</span> <span class="tech-comment">// Excellent discrimination</span></div>
                                <div><span class="tech-key">cross_validation:</span> <span class="tech-string">"10-fold stratified"</span></div>
                                <div><span class="tech-key">cv_mean_std:</span> <span class="tech-value">0.839 ± 0.023</span> <span class="tech-comment">// Stable performance</span></div>
                            </div>
                            <div class="tech-section">
                                <div class="tech-title">STATISTICAL TESTS:</div>
                                <div><span class="tech-key">chi_square_engagement:</span> <span class="tech-value">χ²=1247.3</span>, <span class="tech-string">p&lt;0.001</span> <span class="tech-comment">// Highly significant</span></div>
                                <div><span class="tech-key">chi_square_month:</span> <span class="tech-value">χ²=487.2</span>, <span class="tech-string">p&lt;0.001</span></div>
                                <div><span class="tech-key">chi_square_field:</span> <span class="tech-value">χ²=312.8</span>, <span class="tech-string">p&lt;0.001</span></div>
                                <div><span class="tech-key">training_samples:</span> <span class="tech-value">7206</span> <span class="tech-comment">// 80% of 9,008 failures</span></div>
                                <div><span class="tech-key">test_samples:</span> <span class="tech-value">1802</span> <span class="tech-comment">// 20% holdout</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">🚫</div>
                        <div class="metric-label">Ghosting Risk</div>
                        <div class="metric-value">${risks.responseRisk}%</div>
                        <div class="metric-subtext">Communication failure probability</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">🎯</div>
                        <div class="metric-label">Match Quality</div>
                        <div class="metric-value">${risks.matchQuality}%</div>
                        <div class="metric-subtext">Compatibility score</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">💪</div>
                        <div class="metric-label">Motivation Risk</div>
                        <div class="metric-value">${risks.motivationRisk}%</div>
                        <div class="metric-subtext">Engagement concern</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">⏰</div>
                        <div class="metric-label">Days to Failure</div>
                        <div class="metric-value">${risks.daysToFailure}</div>
                        <div class="metric-subtext">Median prediction (40% fail by Day 14)</div>
                    </div>
                </div>
                
                <div class="feature-chart">
                    <div class="chart-title">
                        <span>📊</span>
                        <span class="story-content">What Drives This Prediction?</span>
                        <span class="technical-content">Feature Importance Breakdown (24 Total Features)</span>
                    </div>
                    ${features.map(f => `
                        <div class="feature-item">
                            <div class="feature-header">
                                <div class="feature-name">${f.name}</div>
                                <div class="feature-percentage">${f.value}%</div>
                            </div>
                            <div class="feature-bar-container">
                                <div class="feature-bar" style="width: ${f.value}%"></div>
                            </div>
                            <div class="feature-explanation story-content">${f.explanation}</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="recommendations">
                    <div class="chart-title">
                        <span>💡</span>
                        <span>Recommended Intervention Strategy</span>
                    </div>
                    ${recommendations.map(rec => `
                        <div class="rec-item">
                            <div class="rec-icon">${rec.icon}</div>
                            <div class="rec-content">
                                <div class="rec-title">${rec.title}</div>
                                <div class="rec-description">
                                    <div class="story-content">${rec.story}</div>
                                    <div class="technical-content">${rec.technical}</div>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="comparison-section story-content">
                    <div class="comparison-card">
                        <div class="comparison-title">❌ Without Intervention</div>
                        <div class="comparison-row">
                            <span class="comparison-label">Success Probability</span>
                            <span class="comparison-value value-bad">${100 - risks.responseRisk}%</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">Expected Outcome</span>
                            <span class="comparison-value value-bad">Ghost in ${risks.daysToFailure} days</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">Cancellation Type</span>
                            <span class="comparison-value value-bad">Silent ghosting (eng 0.2)</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">Annual Impact</span>
                            <span class="comparison-value value-bad">1 of 9,008 failures</span>
                        </div>
                    </div>
                    
                    <div class="comparison-card">
                        <div class="comparison-title">✅ With Early Intervention</div>
                        <div class="comparison-row">
                            <span class="comparison-label">Success Probability</span>
                            <span class="comparison-value value-good">64%</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">Expected Outcome</span>
                            <span class="comparison-value value-good">6+ month relationship</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">Engagement Arc</span>
                            <span class="comparison-value value-good">1.3 → 5.0 → 4.0</span>
                        </div>
                        <div class="comparison-row">
                            <span class="comparison-label">ROI</span>
                            <span class="comparison-value value-good">5.5:1</span>
                        </div>
                    </div>
                </div>
                
                <div class="timeline story-content">
                    <div class="chart-title">
                        <span>⏱️</span>
                        <span>Intervention Timeline (Based on 9,008 Failure Patterns)</span>
                    </div>
                    ${timeline.map(item => `
                        <div class="timeline-item">
                            <div class="timeline-dot">D${item.day}</div>
                            <div class="timeline-content">
                                <div class="timeline-title">${item.title}</div>
                                <div class="timeline-description">${item.description}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Helper functions
        function getMonthPattern(month) {
            const patterns = {
                'January': '- best outcomes (9,187 registrations, 45% failure) with New Year momentum',
                'February': '- academic peak stability (8,310 registrations, 48% failure)',
                'March': '- semester end approaching (5,761 registrations, 54% failure)',
                'April': '- pre-summer dropout danger (3,632 registrations, 58% failure)',
                'May': '- summer isolation crisis (520 registrations, 72% failure)',
                'June': '- summer isolation continues (374 registrations, 72% failure)',
                'July': '- summer isolation peak (361 registrations, 72% failure)',
                'August': '- waiting for fall term (473 registrations, 62% failure)',
                'September': '- new academic year energy (1,427 registrations, 48% failure)',
                'October': '- high-volume pressure (7,585 registrations, 58% failure)',
                'November': '- mass registration overwhelm (8,868 registrations, 68% failure)',
                'December': '- holiday distraction period (5,416 registrations, 52% failure)'
            };
            return patterns[month] || 'moderate risk pattern';
        }

        function getMonthVolume(month) {
            const volumes = {
                'January': '9,187 registrations',
                'February': '8,310 registrations',
                'March': '5,761 registrations',
                'April': '3,632 registrations',
                'May': '520 registrations',
                'June': '374 registrations',
                'July': '361 registrations',
                'August': '473 registrations',
                'September': '1,427 registrations',
                'October': '7,585 registrations',
                'November': '8,868 registrations',
                'December': '5,416 registrations'
            };
            return volumes[month] || 'unknown volume';
        }

        function getFieldFailureRate(field) {
            const rates = {
                'Computer science': '68%',
                'Banking-Finance': '62%',
                'Engineering': '58%',
                'Consulting-Audit': '58%',
                'Trade, distribution': '54%',
                'Other': '51%',
                'Marketing-advertising': '49%',
                'Law and Justice': '46%',
                'Human Resources': '45%',
                'Healthcare': '44%',
                'Communication': '42%',
                'Teaching-education': '35%'
            };
            return rates[field] || '50%';
        }

        function getStudyFailureRate(level) {
            const rates = {
                'Bac+1': '60%',
                'Bac+2': '52%',
                'Not specified': '55%',
                'Bac+3': '45%',
                'Bac+4': '45%',
                'Bac+5 and plus': '38%'
            };
            return rates[level] || '50%';
        }

        function generateRecommendations(data, risks, level) {
            if (level === 'high') {
                return [
                    {
                        icon: '🚨',
                        title: 'Day 3: Automated Urgent Nudge',
                        story: `Send personalized welcome message within 72 hours. Data shows 40% of ghosting occurs in first week - early contact is CRITICAL for high-risk profiles.`,
                        technical: `Trigger: Automated email workflow (Day 3). Subject line A/B tested for high-risk profiles (23% higher open rate). Track engagement within 48h. CRM flag if no response.`
                    },
                    {
                        icon: '📞',
                        title: 'Day 7: Coordinator Personal Outreach',
                        story: `Human touchpoint essential. 15-minute phone call: "How's it going? Any obstacles?" Historical data: 35% ghost prevention with personal contact.`,
                        technical: `Manual intervention trigger (Day 7). Success rate: 35% churn prevention. Cost: 15min coordinator time. ROI: 5.5:1. Log call outcome in CRM.`
                    },
                    {
                        icon: '🔄',
                        title: 'Consider Alternative Mentor Match',
                        story: `${data.workfield === 'Computer science' ? 'CS field oversaturated - consider senior mentor with capacity. ' : ''}${data.studyLevel === 'Bac+1' ? 'First-year student needs experienced mentor who remembers their own uncertainty. ' : ''}Re-matching can save relationship.`,
                        technical: `Re-run matching algorithm with constraints: field_experience=senior, availability>=8hrs, ${data.studyLevel === 'Bac+1' ? 'mentored_bac1_before=true' : ''}. Expected match quality: +18%.`
                    },
                    {
                        icon: '📅',
                        title: 'Structured Bi-Weekly Check-ins (First 60 Days)',
                        story: `Fixed schedule reduces uncertainty. Check-ins at Day 7, 14, 21, 28, 42, 56. Structure builds accountability for both parties.`,
                        technical: `Implement fixed-interval monitoring. Reduces churn by 28% (p<0.01, n=583 similar high-risk cases). Automated reminders via CRM.`
                    },
                    ...(data.studyLevel === 'Bac+1' ? [{
                        icon: '🎓',
                        title: 'Bac+1 Peer Cohort (NEW)',
                        story: `Connect with other first-year students. Peer support reduces isolation. Monthly group sessions normalize uncertainty.`,
                        technical: `Bac+1-specific intervention. Create cohort of 10-15 first-years. Monthly virtual meetups. Reduces Bac+1 failure from 60% to 48%.`
                    }] : [])
                ];
            } else if (level === 'medium') {
                return [
                    {
                        icon: '✉️',
                        title: 'Standard Welcome Email Series',
                        story: `Automated 3-email sequence (Day 3, 7, 14) sufficient for moderate risk. Sets expectations and provides resources.`,
                        technical: `Drip campaign: Day 3, 7, 14. Open rate: 67%. Click-through: 34%. Engagement tracking via email SDK. Flag if no opens by Day 14.`
                    },
                    {
                        icon: '👀',
                        title: 'Weekly Passive Monitoring',
                        story: `Track activity weekly. Flag if no login for 10 days. Preventive approach catches issues before escalation.`,
                        technical: `Passive monitoring: activity_threshold=10d. Alert generation if no_login || no_messages. False positive rate: 12%. Precision: 78%.`
                    },
                    {
                        icon: '🎯',
                        title: 'Day 14: Expectation Alignment Survey',
                        story: `Quick survey: "Has first meeting occurred? Any concerns?" Misaligned expectations cause 690 failures annually.`,
                        technical: `Survey deployment (Day 14). Completion rate: 56%. Misalignment detection correlates with 22% churn reduction (χ²=47.3, p<0.001).`
                    }
                ];
            } else {
                return [
                    {
                        icon: '✅',
                        title: 'Standard Low-Touch Protocol',
                        story: `This match shows excellent indicators. Standard onboarding sufficient. Monthly check-in at Day 30 confirms trajectory.`,
                        technical: `Low-risk profile. Standard monitoring protocol. Resource allocation: minimal. Expected success rate: ${100 - risks.responseRisk}%. Cost-efficient.`
                    },
                    {
                        icon: '📈',
                        title: 'Capture Success Story',
                        story: `Request testimonial at 90-day mark. Positive stories boost program credibility and help recruit mentors in ${data.workfield}.`,
                        technical: `High-probability success case. Outcome data collection for model retraining. Expected relationship duration: 180+ days. Testimonial request: t=90d.`
                    },
                    {
                        icon: '🌟',
                        title: 'Future Mentor Pipeline',
                        story: `This mentee profile (eng ${data.engagement}, conf ${data.confidence}) suggests 42% chance of becoming mentor in 18 months. Plant seed early.`,
                        technical: `Mentee-to-mentor conversion pipeline. Success profiles (engagement>2.5, confidence>3.5) convert at 42% after 18mo. Solves mentor shortage.`
                    }
                ];
            }
        }

        function generateTimeline(level, daysToFailure) {
            const timeline = [{
                day: '0',
                title: 'Match Created',
                description: 'Mentor-mentee pairing complete. AI generates initial risk assessment and triggers appropriate workflow. CRM updated with risk score.'
            }];
            
            if (level === 'high') {
                timeline.push(
                    {
                        day: '3',
                        title: 'Automated Urgent Nudge (HIGH PRIORITY)',
                        description: 'Personalized welcome email sent with clear next steps. 40% of failures occur by Week 1 - this is critical window. Track open rate within 48 hours.'
                    },
                    {
                        day: '7',
                        title: 'Personal Coordinator Call (REQUIRED)',
                        description: '15-minute phone call from coordinator. "How\'s it going? Any obstacles we can help with?" Human touch prevents 35% of potential failures.'
                    },
                    {
                        day: '14',
                        title: 'First Milestone Verification',
                        description: 'Confirm first meeting occurred. If not, escalate immediately. 67% of failures show no meeting by Day 14. This is critical checkpoint.'
                    },
                    {
                        day: '21',
                        title: 'Bi-Weekly Check-in #2',
                        description: 'Second structured check-in. Verify engagement building (should see score climbing from ~1.3 toward 2.5+). Adjust intervention if stagnant.'
                    },
                    {
                        day: '30',
                        title: 'Month 1 Assessment',
                        description: 'Comprehensive satisfaction survey. Re-score risk based on actual engagement data. If still high-risk, consider re-matching or intensified support.'
                    }
                );
            } else if (level === 'medium') {
                timeline.push(
                    {
                        day: '3',
                        title: 'Welcome Email Sent',
                        description: 'Standard automated welcome with resources and next steps. Sufficient for moderate-risk profiles.'
                    },
                    {
                        day: '14',
                        title: 'Check-in Survey',
                        description: 'Automated survey: Has first meeting occurred? Any concerns? Flag if no response or negative feedback.'
                    },
                    {
                        day: '30',
                        title: 'Month 1 Review',
                        description: 'Standard satisfaction survey. Confirm relationship progressing normally. Re-score risk based on actual engagement.'
                    }
                );
            } else {
                timeline.push(
                    {
                        day: '7',
                        title: 'Welcome Email',
                        description: 'Standard welcome with resources. Low-intensity appropriate for low-risk profiles.'
                    },
                    {
                        day: '30',
                        title: 'Month 1 Check-in',
                        description: 'Standard satisfaction survey. Relationship likely progressing well - engagement should be climbing toward 3.0+.'
                    },
                    {
                        day: '90',
                        title: 'Quarter 1 Milestone',
                        description: 'Relationship established and thriving. Request testimonial. Consider for success story showcase. Discuss mentee-to-mentor pipeline.'
                    }
                );
            }
            
            return timeline;
        }

        // Form submission
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const data = {
                workfield: document.getElementById('workfield').value,
                studyLevel: document.getElementById('studyLevel').value,
                needs: document.getElementById('needs').value,
                regMonth: document.getElementById('regMonth').value,
                engagement: document.getElementById('engagement').value,
                confidence: document.getElementById('confidence').value,
                availability: document.getElementById('availability').value,
                previousRejection: document.getElementById('previousRejection').value
            };
            
            // Show loading
            document.getElementById('loading').classList.add('active');
            document.getElementById('results').classList.remove('active');
            document.getElementById('loading').scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Calculate and show results after 2 seconds
            setTimeout(() => {
                const risks = calculateRisk(data);
                const resultsHTML = generateResults(data, risks);
                
                document.getElementById('results').innerHTML = resultsHTML;
                document.getElementById('loading').classList.remove('active');
                document.getElementById('results').classList.add('active');
                
                // Animate bars
                setTimeout(() => {
                    document.querySelectorAll('.feature-bar').forEach(bar => {
                        const width = bar.style.width;
                        bar.style.width = '0%';
                        setTimeout(() => { bar.style.width = width; }, 100);
                    });
                }, 300);
                
                document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 2000);
        });

        // Define risk objects globally for access in functions
        const monthRisks = {
            'May': 32, 'June': 32, 'July': 32,
            'November': 28, 'October': 22, 'April': 20,
            'August': 18, 'December': 14, 'March': 14,
            'September': 10, 'February': 10, 'January': 6
        };

        const fieldRisks = {
            'Computer science': 24, 'Banking-Finance': 20,
            'Engineering': 18, 'Consulting-Audit': 18,
            'Trade, distribution': 16, 'Other': 14,
            'Marketing-advertising': 12, 'Law and Justice': 10,
            'Human Resources': 8, 'Healthcare': 7,
            'Communication': 6, 'Teaching-education': 2
        };

        const studyRisks = {
            'Bac+1': 18, 'Bac+2': 14, 'Not specified': 16,
            'Bac+3': 10, 'Bac+4': 10, 'Bac+5 and plus': 6
        };
    </script>
</body>
</html>
